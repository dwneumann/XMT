{
#************************************************************************
#   Package	: xmt_edit
#   Purpose	: Perl block which, when eval'ed, generates a formatted 
# 		HTML file documenting the interface and implementation
# 		of the C or C++ source file given as input.
#
#   Copyright (c) 1998	Neumann & Associates Information Systems Inc.
#   			legal.info@neumann-associates.com
#   Licensed under the Apache License, Version 2.0 (the "License");
#   you may not use this file except in compliance with the License.
#   You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0
#   
#   Unless required by applicable law or agreed to in writing, software
#   distributed under the License is distributed on an "AS IS" BASIS,
#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#   See the License for the specific language governing permissions and
#   limitations under the License. 
#************************************************************************

$dots="::";
print 
qq{ <!DOCTYPE HTML PUBTRC "-//W3C//DTD HTML 3.2//EN">
    <!--NEWPAGE-->
    <HTML>
    <HEAD>
    <!-- Generated by $pgmname on $date -->
    <TITLE>
      $module->{pkg}$dots$module->{name} (v$module->{version})
    </TITLE>
    </HEAD>
    <BODY>

    <H1>$module->{pkg}$dots$module->{name} (v$module->{version})</H1>
    <H3>Description:</H3>
    $module->{purpose}
};

print "<H3>Dependencies:</H3><TABLE>\n";
foreach $i ( 0 .. $#dependencies )
{
    print " <TR><TD>$dependencies[$i]</TD></TR>\n";
}
print "</TABLE>\n";

print "<H3>Signals Caught:</H3> <TABLE>\n";
foreach $i ( 0 .. $#signals )
{
    print " <TR>$\n";
    print "  <TD>signals[$i]{sig}</TD><TD>:</TD><TD>signals[$i]{disp}</TD>\n";
    print " </TR>$\n";
}
print "</TABLE>\n";

print "<H3>Diagnostics Accepted:</H3> <TABLE>\n";
foreach $i ( 0 .. $#diagnostics )
{
    print " <TR><TD>$diagnostics[$i]</TD></TR>\n";
}
print "</TABLE>\n";

foreach $interface ( qw{ public_funcs protected_funcs private_funcs } )
{
    ($title = $interface) =~ s/(.)(.*)_funcs/\u$1$2/;
    print "<H3>$title Interface:</H3> <TABLE>\n";
    foreach $i ( 0 .. $#{$interface} )
    {
	print qq{ <A HREF="#${$interface}[$i]{proto}">${$interface}[$i]{proto}</A>\n};
    }
    print "</TABLE>\n";
}


foreach $interface ( qw{ public_funcs protected_funcs private_funcs } )
{
    ($title = $interface) =~ s/(.)(.*)_funcs/\u$1$2/;
    print "<BR><HR> <H2>$title Function Descriptions:</H2>\n";
    foreach $i ( 0 .. $#{$interface} )
    {
	print qq{<A NAME="${$interface}[$i]{proto}"> </A>\n};
	print "<H3>${$interface}[$i]{proto}</H3>\n";
	print "<H5>Purpose:</H5>\n${$interface}[$i]{purpose}\n";
	print "<H5>Parameters:</H5> <TABLE>\n";

	foreach $a ( 0 .. $#{${$interface}[$i]{args}} )
	{
	    print "<TR>\n";
	    print "  <TD>${$interface}[$i]{args}[$a]{type}</TD>";
	    print "  <TD>${$interface}[$i]{args}[$a]{name}</TD>";
	    print "  <TD>: (<I>${$interface}[$i]{args}[$a]{passed}</I>)</TD>";
	    print "  <TD>${$interface}[$i]{args}[$a]{meaning}</TD>";
	    print "</TR>\n";
	}
	print "</TABLE>\n";

	print "<H5>Values Returned:</H5> <TABLE>\n";
	foreach $r ( 0 .. $#{${$interface}[$i]{rtnvals}} )
	{
	    print "<TR>\n";
	    print "  <TD>${$interface}[$i]{rtnvals}[$r]{val}</TD><TD>:</TD>";
	    print "  <TD>${$interface}[$i]{rtnvals}[$r]{meaning}</TD>\n";
	    print "</TR>\n";
	}
	print "</TABLE>\n";

	print "<H5>Exceptions Thrown:</H5> <TABLE>\n";
	foreach $r ( 0 .. $#{${$interface}[$i]{exceptions}} )
	{
	    print "<TR>\n";
	    print "  <TD>${$interface}[$i]{exceptions}[$r]{val}</TD><TD>:</TD>";
	    print "  <TD>${$interface}[$i]{exceptions}[$r]{meaning}</TD>\n";
	    print "</TR>\n";
	}
	print "</TABLE>\n";
    }
}

print "</BODY>\n</HTML>\n ";
}
